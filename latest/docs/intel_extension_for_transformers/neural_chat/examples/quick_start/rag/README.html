<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Build RAG (retriveval augment generation) example with Intel® Extension for Transformers neural-chat on Intel GPU &mdash; Intel® Extension for Transformers 0.1.dev1+g7bebb01 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/custom.css?v=68dfede1" />

  
<script type="text/javascript">
  // Configure TMS settings
  window.wapProfile = 'profile-microsite'; // This is mapped by WAP authorize value
  window.wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
  window.wapSection = "intel-extension-for-transformers"; // WAP team will give you a unique section for your site
  window.wapEnv = 'prod'; // environment to be use in Adobe Tags.
  // Load TMS
  (() => {
        let url = 'https://www.intel.com/content/dam/www/global/wap/main/wap-microsite.js';
        let po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        let s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  }) ();
</script>

    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../index.html" class="icon icon-home">
            Intel® Extension for Transformers
          </a>
            <div class="version">
              <a href="../../../../../../../versions.html">latest▼</a>
              <p>Click link above to switch version</p>
            </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../api_doc/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../SECURITY.html">Security Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../release.html">Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../legal.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/intel/intel-extension-for-transformers">Repo</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">Intel® Extension for Transformers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Build RAG (retriveval augment generation) example with Intel® Extension for Transformers neural-chat on Intel GPU</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../_sources/docs/intel_extension_for_transformers/neural_chat/examples/quick_start/rag/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="build-rag-retriveval-augment-generation-example-with-intel-extension-for-transformers-neural-chat-on-intel-gpu">
<h1>Build RAG (retriveval augment generation) example with Intel® Extension for Transformers neural-chat on Intel GPU<a class="headerlink" href="#build-rag-retriveval-augment-generation-example-with-intel-extension-for-transformers-neural-chat-on-intel-gpu" title="Link to this heading"></a></h1>
</section>
<section id="setup-environment">
<h1>1. Setup Environment<a class="headerlink" href="#setup-environment" title="Link to this heading"></a></h1>
<section id="prerequisite">
<h2>prerequisite<a class="headerlink" href="#prerequisite" title="Link to this heading"></a></h2>
<p>GPU driver and oneAPI 2024.0 is required.</p>
</section>
<section id="install-intel-extension-for-transformers">
<h2>1.1 Install intel-extension-for-transformers<a class="headerlink" href="#install-intel-extension-for-transformers" title="Link to this heading"></a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="w"> </span><span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span><span class="w"> </span><span class="n">activate</span><span class="w"> </span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="w"> </span>

<span class="n">source</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="n">oneapi</span><span class="o">/</span><span class="n">setvars</span><span class="p">.</span><span class="n">sh</span>

<span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//github.com/intel/intel-extension-for-transformers.git ~/itrex</span>
<span class="n">cp</span><span class="w"> </span><span class="n">requirements</span><span class="o">-</span><span class="n">gpu</span><span class="p">.</span><span class="n">patch</span><span class="w"> </span><span class="o">~/</span><span class="n">itrex</span>
<span class="n">cd</span><span class="w"> </span><span class="o">~/</span><span class="n">itrex</span>
<span class="n">git</span><span class="w"> </span><span class="n">checkout</span><span class="w"> </span><span class="n">v1</span><span class="mf">.4</span><span class="n">rc1</span>

<span class="n">patch</span><span class="w"> </span><span class="o">-</span><span class="n">p1</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="n">requirements</span><span class="o">-</span><span class="n">gpu</span><span class="p">.</span><span class="n">patch</span>

<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">requirements</span><span class="o">-</span><span class="n">gpu</span><span class="p">.</span><span class="n">txt</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="p">.</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">accelerate</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">transformers_stream_generator</span>
</pre></div>
</div>
</section>
<section id="install-neural-chat-dependency">
<h2>1.2 Install neural-chat dependency<a class="headerlink" href="#install-neural-chat-dependency" title="Link to this heading"></a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span><span class="w"> </span><span class="o">~/</span><span class="n">itrex</span><span class="o">/</span><span class="n">intel_extension_for_transformers</span><span class="o">/</span><span class="n">neural_chat</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">requirements_xpu</span><span class="p">.</span><span class="n">txt</span><span class="err">`</span>
</pre></div>
</div>
</section>
<section id="install-retrieval-dependency">
<h2>1.3 Install retrieval dependency<a class="headerlink" href="#install-retrieval-dependency" title="Link to this heading"></a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span><span class="w"> </span><span class="o">~/</span><span class="n">itrex</span><span class="o">/</span><span class="n">intel_extension_for_transformers</span><span class="o">/</span><span class="n">neural_chat</span><span class="o">/</span><span class="n">pipeline</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">retrieval</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span>
</pre></div>
</div>
</section>
</section>
<section id="run-the-rag-in-command-mode">
<h1>2. Run the RAG in command mode<a class="headerlink" href="#run-the-rag-in-command-mode" title="Link to this heading"></a></h1>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>Example 1. Run the example with RAG</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">python</span><span class="w"> </span><span class="n">retrieval</span><span class="p">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Example 2. Run the example disable RAG</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">python</span><span class="w"> </span><span class="n">retrieval</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">retrieval</span>
</pre></div>
</div>
</section>
</section>
<section id="run-rag-in-client-server-mode">
<h1>3. Run RAG in client server mode<a class="headerlink" href="#run-rag-in-client-server-mode" title="Link to this heading"></a></h1>
<section id="start-the-service">
<h2>3.1 Start the service<a class="headerlink" href="#start-the-service" title="Link to this heading"></a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">python</span><span class="w"> </span><span class="n">neural_ser</span><span class="p">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Here is the completely output:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">xiguiwang</span><span class="o">/</span><span class="n">ws2</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">torchvision</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">image</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span><span class="w"> </span><span class="n">UserWarning</span><span class="o">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="n">Python</span><span class="w"> </span><span class="n">extension</span><span class="o">:</span><span class="w"> </span><span class="err">&#39;&#39;</span><span class="n">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">plan</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="n">functionality</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="err">`</span><span class="n">torchvision</span><span class="p">.</span><span class="n">io</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">warning</span><span class="p">.</span><span class="w"> </span><span class="n">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">wrong</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="err">`</span><span class="n">libjpeg</span><span class="err">`</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="err">`</span><span class="n">libpng</span><span class="err">`</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">building</span><span class="w"> </span><span class="err">`</span><span class="n">torchvision</span><span class="err">`</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">source</span><span class="o">?</span>
<span class="w">  </span><span class="n">warn</span><span class="p">(</span>
<span class="n">Namespace</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="err">&#39;</span><span class="p">.</span><span class="o">/</span><span class="n">neuralchat</span><span class="p">.</span><span class="n">yaml</span><span class="err">&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">35</span><span class="p">,</span><span class="mi">388</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">datasets</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">PyTorch</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">2.1.0</span><span class="n">a0</span><span class="o">+</span><span class="n">cxx11</span><span class="p">.</span><span class="n">abi</span><span class="w"> </span><span class="n">available</span><span class="p">.</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">xiguiwang</span><span class="o">/</span><span class="n">ws2</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">transformers</span><span class="o">/</span><span class="n">deepspeed</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="w"> </span><span class="n">FutureWarning</span><span class="o">:</span><span class="w"> </span><span class="n">transformers</span><span class="p">.</span><span class="n">deepspeed</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">deepspeed</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">transformers</span><span class="p">.</span><span class="n">integrations</span>
<span class="w">  </span><span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">xiguiwang</span><span class="o">/</span><span class="n">ws2</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">langchain</span><span class="o">/</span><span class="n">document_loaders</span><span class="o">/</span><span class="n">__init__</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="w"> </span><span class="n">LangChainDeprecationWarning</span><span class="o">:</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="n">loaders</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="p">.</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">langchain</span><span class="o">==</span><span class="mf">0.2.0</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">instead</span><span class="o">:</span>

<span class="err">`</span><span class="n">from</span><span class="w"> </span><span class="n">langchain_community</span><span class="p">.</span><span class="n">document_loaders</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">UnstructuredMarkdownLoader</span><span class="err">`</span><span class="p">.</span>

<span class="n">To</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="err">`</span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="err">`</span><span class="p">.</span>
<span class="w">  </span><span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">xiguiwang</span><span class="o">/</span><span class="n">ws2</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">langchain</span><span class="o">/</span><span class="n">retrievers</span><span class="o">/</span><span class="n">__init__</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="w"> </span><span class="n">LangChainDeprecationWarning</span><span class="o">:</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">retriever</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="p">.</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">langchain</span><span class="o">==</span><span class="mf">0.2.0</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">instead</span><span class="o">:</span>

<span class="err">`</span><span class="n">from</span><span class="w"> </span><span class="n">langchain_community</span><span class="p">.</span><span class="n">retrievers</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">BM25Retriever</span><span class="err">`</span><span class="p">.</span>

<span class="n">To</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="err">`</span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="err">`</span><span class="p">.</span>
<span class="w">  </span><span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">xiguiwang</span><span class="o">/</span><span class="n">ws2</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">itrex</span><span class="o">-</span><span class="n">rag</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">langchain</span><span class="o">/</span><span class="n">embeddings</span><span class="o">/</span><span class="n">__init__</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="w"> </span><span class="n">LangChainDeprecationWarning</span><span class="o">:</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">embeddings</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="p">.</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">langchain</span><span class="o">==</span><span class="mf">0.2.0</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">instead</span><span class="o">:</span>

<span class="err">`</span><span class="n">from</span><span class="w"> </span><span class="n">langchain_community</span><span class="p">.</span><span class="n">embeddings</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">GooglePalmEmbeddings</span><span class="err">`</span><span class="p">.</span>

<span class="n">To</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="err">`</span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">langchain</span><span class="o">-</span><span class="n">community</span><span class="err">`</span><span class="p">.</span>
<span class="w">  </span><span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span>
<span class="n">create</span><span class="w"> </span><span class="n">retrieval</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">instance</span><span class="p">...</span>
<span class="n">plugin</span><span class="w"> </span><span class="n">parameters</span><span class="o">:</span><span class="w">  </span><span class="p">{</span><span class="err">&#39;</span><span class="n">retrieval_type</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="err">&#39;</span><span class="k">default</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">input_path</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="err">&#39;</span><span class="p">.</span><span class="o">/</span><span class="n">text</span><span class="o">/</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">embedding_model</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">BAAI</span><span class="o">/</span><span class="n">bge</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">en</span><span class="o">-</span><span class="n">v1</span><span class="mf">.5</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">persist_dir</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="err">&#39;</span><span class="p">.</span><span class="o">/</span><span class="n">output</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">max_length</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">process</span><span class="err">&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="p">}</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">37</span><span class="p">,</span><span class="mi">228</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sentence_transformers</span><span class="p">.</span><span class="n">SentenceTransformer</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">pretrained</span><span class="w"> </span><span class="n">SentenceTransformer</span><span class="o">:</span><span class="w"> </span><span class="n">BAAI</span><span class="o">/</span><span class="n">bge</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">en</span><span class="o">-</span><span class="n">v1</span><span class="mf">.5</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">318</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sentence_transformers</span><span class="p">.</span><span class="n">SentenceTransformer</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">pytorch</span><span class="w"> </span><span class="n">device_name</span><span class="o">:</span><span class="w"> </span><span class="n">cpu</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">331</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">easyocr</span><span class="p">.</span><span class="n">easyocr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">WARNING</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Neither</span><span class="w"> </span><span class="n">CUDA</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">MPS</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">defaulting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="p">.</span><span class="w"> </span><span class="n">Note</span><span class="o">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">faster</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">44</span><span class="p">,</span><span class="mi">677</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">easyocr</span><span class="p">.</span><span class="n">easyocr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">WARNING</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Neither</span><span class="w"> </span><span class="n">CUDA</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">MPS</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">defaulting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="p">.</span><span class="w"> </span><span class="n">Note</span><span class="o">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">faster</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">GPU</span><span class="p">.</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">726</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">uploaded</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">finished</span><span class="p">.</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">726</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="n">documents</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">transferred</span><span class="p">.</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">733</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">chromadb</span><span class="p">.</span><span class="n">telemetry</span><span class="p">.</span><span class="n">product</span><span class="p">.</span><span class="n">posthog</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Anonymized</span><span class="w"> </span><span class="n">telemetry</span><span class="w"> </span><span class="n">enabled</span><span class="p">.</span><span class="w"> </span><span class="n">See</span><span class="w">                     </span><span class="n">https</span><span class="o">:</span><span class="c1">//docs.trychroma.com/telemetry for more information.</span>
<span class="nl">Batches</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">01</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w">  </span><span class="mf">1.09</span><span class="n">s</span><span class="o">/</span><span class="n">it</span><span class="p">]</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">300</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ERROR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">retrieval</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">remains</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">scope</span><span class="p">.</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">300</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">retriever</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">built</span><span class="p">.</span>
<span class="n">Loading</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">Intel</span><span class="o">/</span><span class="n">neural</span><span class="o">-</span><span class="n">chat</span><span class="mi">-7</span><span class="n">b</span><span class="o">-</span><span class="n">v3</span><span class="mi">-1</span>
<span class="n">model</span><span class="mo">-00001</span><span class="o">-</span><span class="n">of</span><span class="mf">-00002.</span><span class="n">safetensors</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mf">9.94</span><span class="n">G</span><span class="o">/</span><span class="mf">9.94</span><span class="n">G</span><span class="w"> </span><span class="p">[</span><span class="mi">12</span><span class="o">:</span><span class="mi">37</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w"> </span><span class="mf">13.1</span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
<span class="n">Downloading</span><span class="w"> </span><span class="n">shards</span><span class="o">:</span><span class="w">  </span><span class="mi">50</span><span class="o">%|</span><span class="err">█████████████████████████████████████████████▌</span><span class="w">                                             </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mi">12</span><span class="o">:</span><span class="mi">39</span><span class="o">&lt;</span><span class="mi">12</span><span class="o">:</span><span class="mi">39</span><span class="p">,</span><span class="w"> </span><span class="mf">759.82</span><span class="n">s</span><span class="o">/</span><span class="n">it</span><span class="p">]</span>
<span class="n">model</span><span class="mo">-00002</span><span class="o">-</span><span class="n">of</span><span class="mf">-00002.</span><span class="n">safetensors</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mf">4.54</span><span class="n">G</span><span class="o">/</span><span class="mf">4.54</span><span class="n">G</span><span class="w"> </span><span class="p">[</span><span class="mo">05</span><span class="o">:</span><span class="mi">45</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w"> </span><span class="mf">13.2</span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
<span class="n">Downloading</span><span class="w"> </span><span class="n">shards</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mi">18</span><span class="o">:</span><span class="mi">27</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w"> </span><span class="mf">553.63</span><span class="n">s</span><span class="o">/</span><span class="n">it</span><span class="p">]</span>
<span class="n">Loading</span><span class="w"> </span><span class="n">checkpoint</span><span class="w"> </span><span class="n">shards</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">█████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">02</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w">  </span><span class="mf">1.07</span><span class="n">s</span><span class="o">/</span><span class="n">it</span><span class="p">]</span>
<span class="n">generation_config</span><span class="p">.</span><span class="n">json</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">█████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">111</span><span class="o">/</span><span class="mi">111</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w"> </span><span class="mf">48.5</span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">803</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">loaded</span><span class="p">.</span>
<span class="n">Loading</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="p">...</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="n">Started</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="p">[</span><span class="mi">1520808</span><span class="p">]</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="n">Waiting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">startup</span><span class="p">.</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="n">Application</span><span class="w"> </span><span class="n">startup</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="n">Uvicorn</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//0.0.0.0:8000 (Press CTRL+C to quit)</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">54544</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/chat/completions HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">422</span><span class="w"> </span><span class="n">Unprocessable</span><span class="w"> </span><span class="n">Entity</span>
<span class="nl">Batches</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w">  </span><span class="mf">3.42</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">241</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Chat</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">QA</span><span class="w"> </span><span class="n">Agent</span><span class="p">.</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">42680</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/chat/completions HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">38610</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/models HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">53712</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/models HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">38518</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/models HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">34442</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/models HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">INFO</span><span class="p">:</span><span class="w">     </span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">60016</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;POST /v1/chat/completions HTTP/1.1&quot;</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">Batches</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="o">%|</span><span class="err">███████████████████████████████████████████████████████████████████████████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">&lt;</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">,</span><span class="w">  </span><span class="mf">5.41</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
<span class="mi">2024</span><span class="mo">-03</span><span class="mi">-18</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mo">01</span><span class="p">,</span><span class="mi">205</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Chat</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">QA</span><span class="w"> </span><span class="n">Agent</span><span class="p">.</span>
</pre></div>
</div>
<p>Now the server is ready to provide service on 8000 port.
Next we will start a client to connect this server 8000 port in section 3.3.</p>
<section id="verify-the-connection-to-service-is-ok">
<h3>3.1.1 Verify the connection to service is OK.<a class="headerlink" href="#verify-the-connection-to-service-is-ok" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-vv</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">http://127.0.0.1:8000/v1/chat/completions</span></code></p>
<p>Make sure there is no network connection issue, no proxy setting issue.</p>
</section>
<section id="sent-a-request-to-neural-chat-server">
<h3>3.1.2 Sent a request to neural-chat server<a class="headerlink" href="#sent-a-request-to-neural-chat-server" title="Link to this heading"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:8000/v1/chat/completions \</span>
<span class="c1">    -H &quot;Content-Type: application/json&quot; \</span>
<span class="c1">    -d &#39;{</span>
<span class="w">    </span><span class="s">&quot;model&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Intel/neural-chat-7b-v3-1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;messages&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="s">&quot;role&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;system&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;content&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;You are a helpful assistant.&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="s">&quot;role&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;user&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;content&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Tell me about Intel Xeon Scalable Processors.&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span><span class="err">&#39;</span>
</pre></div>
</div>
<p>You will get answer from RAG server.</p>
</section>
</section>
<section id="set-up-ui-environment">
<h2>3.2 Set up UI environment<a class="headerlink" href="#set-up-ui-environment" title="Link to this heading"></a></h2>
<p>The service is ready, but we have to access it through command.
Now we set up the user interfaces.</p>
<p>Create conda envitonment</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">chatbot</span><span class="o">-</span><span class="n">ui</span><span class="w"> </span><span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span><span class="w"> </span><span class="n">activate</span><span class="w"> </span><span class="n">chatbot</span><span class="o">-</span><span class="n">ui</span>

<span class="n">cd</span><span class="w"> </span><span class="n">itrex</span><span class="o">/</span><span class="n">intel_extension_for_transformers</span><span class="o">/</span><span class="n">neural_chat</span><span class="o">/</span><span class="n">ui</span><span class="o">/</span><span class="n">gradio</span><span class="o">/</span><span class="n">basic</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">gradio</span><span class="o">==</span><span class="mf">3.36.0</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">pydantic</span><span class="o">==</span><span class="mf">1.10.13</span>
</pre></div>
</div>
</section>
<section id="start-the-web-service">
<h2>3.3 Start the web service<a class="headerlink" href="#start-the-web-service" title="Link to this heading"></a></h2>
<section id="set-rag-server-setting">
<h3>3.3.1 Set RAG server setting<a class="headerlink" href="#set-rag-server-setting" title="Link to this heading"></a></h3>
<p>edit app.pyt to set the server port:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span><span class="w"> </span><span class="o">~/</span><span class="n">itrex</span><span class="o">/</span><span class="n">intel_extension_for_transformers</span><span class="o">/</span><span class="n">neural_chat</span><span class="o">/</span><span class="n">ui</span><span class="o">/</span><span class="n">gradio</span><span class="o">/</span><span class="n">basic</span>
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">app.py</span></code> line 124-126,</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="mi">124</span><span class="w"> </span><span class="n">controller_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://127.0.0.1:8000&quot;</span>
<span class="mi">125</span><span class="w"> </span><span class="n">openai_api_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EMPTY&quot;</span>
<span class="mi">126</span><span class="w"> </span><span class="n">openai_api_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://127.0.0.1:8000/v1/&quot;</span>
</pre></div>
</div>
<p>This is the RAG service IP_Address and port started in section 3.1. Since we access it from the same machine, set it a local IP.</p>
</section>
<section id="set-web-server-port">
<h3>3.3.2 Set Web server port<a class="headerlink" href="#set-web-server-port" title="Link to this heading"></a></h3>
<p>Edit <code class="docutils literal notranslate"><span class="pre">app.py</span></code> line 742-746,</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="mi">742</span><span class="w">     </span><span class="n">demo</span><span class="p">.</span><span class="n">queue</span><span class="p">(</span>
<span class="mi">743</span><span class="w">         </span><span class="n">concurrency_count</span><span class="o">=</span><span class="n">concurrency_count</span><span class="p">,</span><span class="w"> </span><span class="n">status_update_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">api_open</span><span class="o">=</span><span class="n">False</span>
<span class="mi">744</span><span class="w">     </span><span class="p">).</span><span class="n">launch</span><span class="p">(</span>
<span class="mi">745</span><span class="w">         </span><span class="n">server_name</span><span class="o">=</span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">server_port</span><span class="o">=</span><span class="mi">8088</span><span class="p">,</span><span class="w"> </span><span class="n">share</span><span class="o">=</span><span class="n">share</span><span class="p">,</span><span class="w"> </span><span class="n">max_threads</span><span class="o">=</span><span class="mi">200</span>
<span class="mi">746</span><span class="w">     </span><span class="p">)</span>
</pre></div>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">server_port=8088</span></code>. This is the web service for the browser UI.</p>
</section>
<section id="id1">
<h3>3.3.3 Start the web service<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">python</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Check this machine IP address, we will access this machine through you web browser.</p>
<p><code class="docutils literal notranslate"><span class="pre">http://IP:8088</span></code></p>
<p>First your request will be sent to the web server, then the app sent forward your request (as well as other assistant message) to your RAG service.
after RAG response are back to this app, and it feedback the response to your browser.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Intel® Extension for Transformers, Intel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   <jinja2.runtime.BlockReference object at 0x7fdd92d6c0d0> 
  <p></p><div><a href='https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html' data-cookie-notice='true'>Cookies</a> <a href='https://www.intel.com/content/www/us/en/privacy/intel-privacy-notice.html'>| Privacy</a></div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>