<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setup Environment &mdash; Intel® Extension for Transformers 0.1.dev1+ga864bb2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=68dfede1" />

  
<script type="text/javascript">
  // Configure TMS settings
  window.wapProfile = 'profile-microsite'; // This is mapped by WAP authorize value
  window.wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
  window.wapSection = "intel-extension-for-transformers"; // WAP team will give you a unique section for your site
  window.wapEnv = 'prod'; // environment to be use in Adobe Tags.
  // Load TMS
  (() => {
        let url = 'https://www.intel.com/content/dam/www/global/wap/main/wap-microsite.js';
        let po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        let s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  }) ();
</script>

    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Intel® Extension for Transformers
          </a>
            <div class="version">
              <a href="../../../../../../../../versions.html">latest▼</a>
              <p>Click link above to switch version</p>
            </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../api_doc/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../SECURITY.html">OpenSSF Badge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../SECURITY.html#security-policy">Security Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../release.html">Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../legal.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/intel/intel-extension-for-transformers">Repo</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Intel® Extension for Transformers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setup Environment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/docs/intel_extension_for_transformers/neural_chat/examples/deployment/photo_ai/backend/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This README is intended to guide you through setting up the backend for a Photo AI demo using the NeuralChat framework. You can deploy it on various platforms, including Intel XEON Scalable Processors, Habana’s Gaudi processors (HPU), Intel Data Center GPU and Client GPU, Nvidia Data Center GPU and Client GPU.</p>
<section id="setup-environment">
<h1>Setup Environment<a class="headerlink" href="#setup-environment" title="Link to this heading"></a></h1>
<section id="setup-conda">
<h2>Setup Conda<a class="headerlink" href="#setup-conda" title="Link to this heading"></a></h2>
<p>First, you need to install and configure the Conda environment:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and install Miniconda</span>
wget<span class="w"> </span>https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash<span class="w"> </span>Miniconda*.sh
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>
</div>
</section>
<section id="install-numactl">
<h2>Install numactl<a class="headerlink" href="#install-numactl" title="Link to this heading"></a></h2>
<p>Next, install the numactl library:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>numactl
</pre></div>
</div>
</section>
<section id="install-python-dependencies">
<h2>Install Python dependencies<a class="headerlink" href="#install-python-dependencies" title="Link to this heading"></a></h2>
<p>Install the following Python dependencies using Conda:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>astunparse<span class="w"> </span>ninja<span class="w"> </span>pyyaml<span class="w"> </span>mkl<span class="w"> </span>mkl-include<span class="w"> </span>setuptools<span class="w"> </span>cmake<span class="w"> </span>cffi<span class="w"> </span>typing_extensions<span class="w"> </span>future<span class="w"> </span>six<span class="w"> </span>requests<span class="w"> </span>dataclasses<span class="w"> </span>-y
conda<span class="w"> </span>install<span class="w"> </span>jemalloc<span class="w"> </span>gperftools<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-y
conda<span class="w"> </span>install<span class="w"> </span>git-lfs<span class="w"> </span>-y
<span class="c1"># install libGL.so.1 for opencv</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>libgl1-mesa-glx
</pre></div>
</div>
<p>Install other dependencies using pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>../../../requirements.txt
</pre></div>
</div>
</section>
<section id="install-models">
<h2>Install Models<a class="headerlink" href="#install-models" title="Link to this heading"></a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git-lfs<span class="w"> </span>install
<span class="c1"># download neural-chat-7b-v3-1 model for NER plugin</span>
git<span class="w"> </span>clone<span class="w"> </span>https://huggingface.co/Intel/neural-chat-7b-v3-1
<span class="c1"># download spacy model for NER post process</span>
python<span class="w"> </span>-m<span class="w"> </span>spacy<span class="w"> </span>download<span class="w"> </span>en_core_web_lg
</pre></div>
</div>
</section>
</section>
<section id="setup-database">
<h1>Setup Database<a class="headerlink" href="#setup-database" title="Link to this heading"></a></h1>
<section id="install-mysql">
<h2>Install MySQL<a class="headerlink" href="#install-mysql" title="Link to this heading"></a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># install mysql</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>mysql-server
<span class="c1"># start mysql server</span>
systemctl<span class="w"> </span>status<span class="w"> </span>mysql
</pre></div>
</div>
</section>
<section id="create-tables">
<h2>Create Tables<a class="headerlink" href="#create-tables" title="Link to this heading"></a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../../../utils/database/
<span class="c1"># login mysql</span>
mysql
<span class="nb">source</span><span class="w"> </span>./init_db_ai_photos.sql
</pre></div>
</div>
</section>
<section id="create-image-database">
<h2>Create Image Database<a class="headerlink" href="#create-image-database" title="Link to this heading"></a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>/home/nfs_images
<span class="nb">export</span><span class="w"> </span><span class="nv">IMAGE_SERVER_IP</span><span class="o">=</span><span class="s2">&quot;your.server.ip&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="configure-photoai-yaml">
<h1>Configure photoai.yaml<a class="headerlink" href="#configure-photoai-yaml" title="Link to this heading"></a></h1>
<p>You can customize the configuration file <code class="docutils literal notranslate"><span class="pre">photoai.yaml</span></code> to match your environment setup. Here’s a table to help you understand the configurable options:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Item</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>host</td>
<td>127.0.0.1</td>
</tr>
<tr>
<td>port</td>
<td>9000</td>
</tr>
<tr>
<td>model_name_or_path</td>
<td>"./neural-chat-7b-v3-1"</td>
</tr>
<tr>
<td>device</td>
<td>"auto"</td>
</tr>
<tr>
<td>asr.enable</td>
<td>true</td>
</tr>
<tr>
<td>tts.enable</td>
<td>true</td>
</tr>
<tr>
<td>ner.enable</td>
<td>true</td>
</tr>
<tr>
<td>tasks_list</td>
<td>['voicechat', 'photoai']</td>
</tr>
</tbody>
</table></section>
<section id="configure-environment-variables">
<h1>Configure Environment Variables<a class="headerlink" href="#configure-environment-variables" title="Link to this heading"></a></h1>
<p>Configure all of the environment variables in file <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> using <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">XXX=xxx</span></code>. Here’s a table of all the variables needed to configure.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>MYSQL_HOST</td>
<td>127.0.0.1 if you deploy mysql on local server.</td>
</tr>
<tr>
<td>MYSQL_USER</td>
<td>default: 'root'</td>
</tr>
<tr>
<td>MYSQL_PASSWORD</td>
<td>password of the specified user</td>
</tr>
<tr>
<td>MYSQL_PORT</td>
<td>default: 3306</td>
</tr>
<tr>
<td>MYSQL_DB</td>
<td>default: 'ai_photos'</td>
</tr>
<tr>
<td>IMAGE_SERVER_IP</td>
<td>The IP of server which you store user uploaded images</td>
</tr>
<tr>
<td>IMAGE_ROOT_PATH</td>
<td>local path of image storing path</td>
</tr>
<tr>
<td>RETRIEVAL_FILE_PATH</td>
<td>local path of where you store retrieval files</td>
</tr>
<tr>
<td>GOOGLE_API_KEY</td>
<td>your google api key to get gps information from images</td>
</tr>
</tbody>
</table></section>
<section id="run-the-photoai-server">
<h1>Run the PhotoAI server<a class="headerlink" href="#run-the-photoai-server" title="Link to this heading"></a></h1>
<p>To start the PhotoAI server, use the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>nohup<span class="w"> </span>bash<span class="w"> </span>run.sh<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Intel® Extension for Transformers, Intel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   <jinja2.runtime.BlockReference object at 0x7f8b2a63b880> 
  <p></p><div><a href='https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html' data-cookie-notice='true'>Cookies</a> <a href='https://www.intel.com/content/www/us/en/privacy/intel-privacy-notice.html'>| Privacy</a></div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>